<!-- Auction Detail View Component - Complete with Bidding System -->
<div class="bg-white rounded-lg border border-slate-200 shadow-lg p-6">
    <!-- Header with Back Button -->
    <div class="flex justify-between items-start mb-6">
        <button
            onclick="loadAuctions()"
            class="flex items-center text-slate-600 hover:text-slate-900 transition"
        >
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Back to List
        </button>
        
        <!-- Action Buttons -->
        <div class="flex gap-2">
            <button
                onclick="openEditModal({{ auction.id }})"
                class="px-4 py-2 text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg transition font-medium"
                title="Edit"
            >
                <svg class="w-5 h-5 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                </svg>
                Edit
            </button>
            <button
                hx-delete="/api/auctions/{{ auction.id }}"
                hx-confirm="Delete this auction? This cannot be undone."
                onclick="setTimeout(() => loadAuctions(), 500)"
                class="px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-lg transition font-medium"
                title="Delete"
            >
                <svg class="w-5 h-5 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
                Delete
            </button>
        </div>
    </div>

    <!-- Image Carousel/Gallery Section -->
    {% if auction.image_path or auction.image_paths %}
    <div class="mb-6 rounded-lg overflow-hidden shadow-md bg-slate-100">
        <div id="carousel-container" class="relative flex items-center justify-center max-h-[600px] bg-slate-100">
            <!-- Main Image Display -->
            <img 
                id="carousel-image"
                src="/uploads/{{ auction.image_path }}" 
                alt="{{ auction.title }}" 
                class="w-full h-auto max-h-[600px] object-contain"
                loading="lazy"
            >

            <!-- Previous Button -->
            <button
                id="carousel-prev"
                onclick="prevImage()"
                class="absolute left-4 z-10 bg-black/50 hover:bg-black/70 text-white rounded-full p-2 transition"
                style="display: none;"
            >
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </button>

            <!-- Next Button -->
            <button
                id="carousel-next"
                onclick="nextImage()"
                class="absolute right-4 z-10 bg-black/50 hover:bg-black/70 text-white rounded-full p-2 transition"
                style="display: none;"
            >
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </button>
        </div>

        <!-- Carousel Indicators (Dots) -->
        <div id="carousel-indicators" class="flex justify-center gap-2 bg-slate-100 py-3" style="display: none;">
            <!-- Dots will be added by JavaScript -->
        </div>
    </div>
    {% endif %}

    <!-- Auction Title -->
    <h1 class="text-3xl font-serif font-bold text-slate-900 mb-4">
        {{ auction.title }}
    </h1>

    <!-- Meta Information -->
    <div class="flex items-center gap-4 pb-4 mb-6 border-b border-slate-200">
        <div class="flex items-center text-sm text-slate-600">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
            <span>By <strong class="text-slate-900">{{ auction.author }}</strong></span>
        </div>
        <span class="text-slate-300">‚Ä¢</span>
        <div class="flex items-center text-sm text-slate-600">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
            </svg>
            <span>Created: <strong>{{ auction.create_at.strftime('%B %d, %Y at %I:%M %p') }}</strong></span>
        </div>
        {% if auction.update_at != auction.create_at %}
        <span class="text-slate-300">‚Ä¢</span>
        <div class="flex items-center text-sm text-slate-600">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
            </svg>
            <span>Updated: <strong>{{ auction.update_at.strftime('%B %d, %Y at %I:%M %p') }}</strong></span>
        </div>
        {% endif %}
    </div>

    <!-- Auction Content -->
    <div class="prose prose-slate max-w-none mb-8">
        <div class="text-slate-700 leading-relaxed whitespace-pre-wrap">{{ auction.content }}</div>
    </div>

    <!-- ========================================================================
         BIDDING SECTION - 3 COLUMN LAYOUT
         ======================================================================== -->
    <div class="mt-8 grid grid-cols-1 lg:grid-cols-3 gap-6">
        
        <!-- LEFT COLUMN: Auction Status & Price Information -->
        <div class="lg:col-span-1">
            <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-lg border border-slate-200 p-6 sticky top-20">
                
                <!-- Auction Status Badge -->
                <div class="mb-6">
                    {% if auction.is_active %}
                        <span class="inline-block px-3 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-full">
                            üü¢ Active Auction
                        </span>
                    {% else %}
                        <span class="inline-block px-3 py-1 bg-red-100 text-red-700 text-xs font-semibold rounded-full">
                            üî¥ Auction Ended
                        </span>
                    {% endif %}
                </div>

                <!-- Price Information Section -->
                <div class="space-y-4 mb-6 pb-6 border-b border-slate-200">
                    <!-- Starting Price -->
                    <div>
                        <p class="text-xs text-slate-600 font-medium uppercase tracking-wide">Starting Price</p>
                        <p class="text-2xl font-bold text-slate-900">${{ "%.2f"|format(auction.start_price) }}</p>
                    </div>

                    <!-- Current Price (Highest Bid) -->
                    <div>
                        <p class="text-xs text-slate-600 font-medium uppercase tracking-wide">Current Bid</p>
                        <p class="text-3xl font-bold text-blue-600">${{ "%.2f"|format(auction.current_price) }}</p>
                        {% if auction.current_price > auction.start_price %}
                        <p class="text-xs text-green-600 font-medium mt-1">
                            ‚Üë +${{ "%.2f"|format(auction.current_price - auction.start_price) }}
                        </p>
                        {% endif %}
                    </div>

                    <!-- Minimum Next Bid -->
                    <div>
                        <p class="text-xs text-slate-600 font-medium uppercase tracking-wide">Minimum Next Bid</p>
                        <p class="text-xl font-bold text-slate-900">${{ "%.2f"|format(auction.current_price + 1.00) }}</p>
                    </div>
                </div>

                <!-- Time Remaining / Countdown -->
                <div class="mb-6">
                    <p class="text-xs text-slate-600 font-medium uppercase tracking-wide mb-2">Time Remaining</p>
                    <div class="bg-white rounded-lg p-3 border border-slate-200">
                        <p id="countdown" class="text-sm font-mono text-slate-900">Calculating...</p>
                        <p class="text-xs text-slate-500 mt-1">Ends: {{ auction.ends_at.strftime('%B %d, %Y at %I:%M %p') }}</p>
                    </div>
                </div>

                <!-- Winner Info (if auction ended) -->
                {% if not auction.is_active and auction.winner_id %}
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                    <p class="text-xs text-yellow-700 font-medium mb-2">üèÜ Auction Winner</p>
                    <p class="text-sm font-semibold text-yellow-900" id="winner-name">Loading winner info...</p>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- RIGHT COLUMN: Bidding Form & History (2 cols) -->
        <div class="lg:col-span-2 space-y-6">
            
            <!-- Bidding Form Section -->
            {% if auction.is_active %}
            <div class="bg-white rounded-lg border border-slate-200 shadow-md p-6">
                <h3 class="text-lg font-semibold text-slate-900 mb-4">Place Your Bid</h3>
                
                {% if username %}
                <!-- Bid Form (logged in users) -->
                <form id="bid-form" onsubmit="return submitBid(event)">
                    <!-- Bid Amount Input -->
                    <div class="mb-4">
                        <label for="bid-amount" class="block text-sm font-medium text-slate-900 mb-2">
                            Bid Amount <span class="text-red-500">*</span>
                        </label>
                        <div class="relative">
                            <span class="absolute left-3 top-3 text-slate-600 font-semibold">$</span>
                            <input
                                type="number"
                                id="bid-amount"
                                name="bid-amount"
                                step="0.01"
                                min="{{ "%.2f"|format(auction.current_price + 1.00) }}"
                                placeholder="{{ "%.2f"|format(auction.current_price + 1.00) }}"
                                value=""
                                class="w-full pl-8 pr-4 py-2.5 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-slate-50 placeholder-slate-400"
                                required
                            />
                        </div>
                        <p class="text-xs text-slate-500 mt-1">
                            Minimum: ${{ "%.2f"|format(auction.current_price + 1.00) }}
                        </p>
                    </div>

                    <!-- Error Messages -->
                    <div id="bid-error" class="hidden mb-4 p-3 bg-red-50 border border-red-200 rounded-lg">
                        <p id="error-message" class="text-sm text-red-700 font-medium"></p>
                    </div>

                    <!-- Success Messages -->
                    <div id="bid-success" class="hidden mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
                        <p id="success-message" class="text-sm text-green-700 font-medium"></p>
                    </div>

                    <!-- Submit Button -->
                    <button
                        type="submit"
                        id="bid-submit-btn"
                        class="w-full px-4 py-2.5 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition active:scale-95 disabled:bg-gray-400 disabled:cursor-not-allowed"
                    >
                        <span id="btn-text">Place Bid</span>
                        <span id="btn-spinner" class="hidden ml-2 inline-block animate-spin">‚è≥</span>
                    </button>
                </form>
                {% else %}
                <!-- Login Prompt (not logged in) -->
                <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg text-center">
                    <p class="text-sm text-blue-700 font-medium mb-2">You must be logged in to bid</p>
                    <a href="/login" class="text-blue-600 hover:text-blue-800 font-semibold">Login to Bid ‚Üí</a>
                </div>
                {% endif %}
            </div>
            {% else %}
            <!-- Auction Ended Message -->
            <div class="bg-gradient-to-r from-red-50 to-orange-50 rounded-lg border border-red-200 shadow-md p-6 text-center">
                <p class="text-lg font-semibold text-red-700 mb-2">üî¥ Auction Has Ended</p>
                <p class="text-sm text-red-600">
                    This auction ended on {{ auction.ends_at.strftime('%B %d, %Y at %I:%M %p') }}
                </p>
                {% if auction.winner_id %}
                <p class="text-sm text-red-600 mt-2">
                    Winner: <span id="ended-winner-name" class="font-semibold">Loading...</span>
                </p>
                {% else %}
                <p class="text-sm text-orange-600 mt-2">No bids were placed for this auction.</p>
                {% endif %}
            </div>
            {% endif %}

            <!-- Bid History Section -->
            <div class="bg-white rounded-lg border border-slate-200 shadow-md p-6">
                <h3 class="text-lg font-semibold text-slate-900 mb-4">Bid History</h3>
                
                <div id="bid-history-container" class="space-y-3 max-h-96 overflow-y-auto">
                    <!-- Bids will be loaded here via JavaScript -->
                    <div class="text-center py-8">
                        <p class="text-slate-500">Loading bid history...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Actions -->
    <div class="mt-8 pt-6 border-t border-slate-200 flex justify-between items-center">
        <button
            onclick="loadAuctions()"
            class="px-4 py-2 text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg transition font-medium"
        >
            ‚Üê Back to Auctions
        </button>
        
        <div class="text-sm text-slate-500">
            ID: #{{ auction.id }}
        </div>
    </div>
</div>

<script>
    // ========================================================================
    // CAROUSEL MANAGEMENT - MULTIPLE IMAGES SUPPORT
    // ========================================================================
    
    let carouselImages = [];
    let currentImageIndex = 0;

    // Initialize carousel with images
    function initializeCarousel() {
        // Get primary image
        const primaryImage = '{{ auction.image_path }}';
        
        // Get images from image_paths JSON
        {% if auction.image_paths %}
        try {
            // Parse the JSON string from image_paths
            const imagePaths = {{ auction.image_paths | safe }};
            console.log('[CAROUSEL] Parsed image_paths:', imagePaths);
            
            if (Array.isArray(imagePaths) && imagePaths.length > 0) {
                carouselImages = imagePaths;
            } else if (primaryImage) {
                carouselImages = [primaryImage];
            }
        } catch (e) {
            console.error('[CAROUSEL] Error parsing image_paths:', e);
            if (primaryImage) {
                carouselImages = [primaryImage];
            }
        }
        {% else %}
        // Fallback to primary image if no image_paths
        if (primaryImage) {
            carouselImages = [primaryImage];
        }
        {% endif %}
        
        console.log('[CAROUSEL] Total images found:', carouselImages.length);
        console.log('[CAROUSEL] Images:', carouselImages);
        
        // Show/hide buttons based on number of images
        if (carouselImages.length > 1) {
            console.log('[CAROUSEL] Multiple images detected - showing controls');
            document.getElementById('carousel-prev').style.display = 'block';
            document.getElementById('carousel-next').style.display = 'block';
            document.getElementById('carousel-indicators').style.display = 'flex';
            
            // Create indicator dots
            createIndicators();
        } else {
            console.log('[CAROUSEL] Single image - hiding controls');
        }
        
        // Set first image
        if (carouselImages.length > 0) {
            updateCarousel(0);
        }
    }

    // Create indicator dots
    function createIndicators() {
        const indicatorContainer = document.getElementById('carousel-indicators');
        indicatorContainer.innerHTML = ''; // Clear existing
        
        carouselImages.forEach((_, index) => {
            const dot = document.createElement('button');
            dot.type = 'button';
            dot.className = 'w-2 h-2 rounded-full transition-all ';
            
            if (index === 0) {
                dot.className += 'bg-slate-700 w-6';
            } else {
                dot.className += 'bg-slate-400 hover:bg-slate-500';
            }
            
            dot.onclick = (e) => {
                e.preventDefault();
                updateCarousel(index);
            };
            
            indicatorContainer.appendChild(dot);
        });
    }

    // Update carousel display
    function updateCarousel(index) {
        if (carouselImages.length === 0) {
            console.error('[CAROUSEL] No images to display');
            return;
        }
        
        // Validate index
        if (index < 0) index = carouselImages.length - 1;
        if (index >= carouselImages.length) index = 0;
        
        currentImageIndex = index;
        
        // Update image
        const imagePath = carouselImages[index];
        const imgElement = document.getElementById('carousel-image');
        const fullPath = '/uploads/' + imagePath;
        
        console.log('[CAROUSEL] Updating to image', index, ':', imagePath);
        imgElement.src = fullPath;
        imgElement.alt = `{{ auction.title }} - Image ${index + 1}`;
        
        // Update indicators
        updateIndicators();
    }

    // Update indicator dots
    function updateIndicators() {
        const dots = document.querySelectorAll('#carousel-indicators button');
        dots.forEach((dot, index) => {
            if (index === currentImageIndex) {
                dot.className = 'w-6 h-2 rounded-full transition-all bg-slate-700';
            } else {
                dot.className = 'w-2 h-2 rounded-full transition-all bg-slate-400 hover:bg-slate-500';
            }
        });
    }

    // Navigation functions
    function prevImage() {
        console.log('[CAROUSEL] Previous clicked. Current:', currentImageIndex);
        updateCarousel(currentImageIndex - 1);
    }

    function nextImage() {
        console.log('[CAROUSEL] Next clicked. Current:', currentImageIndex);
        updateCarousel(currentImageIndex + 1);
    }

    // Initialize carousel on page load
    document.addEventListener('DOMContentLoaded', function() {
        console.log('[CAROUSEL] Initializing carousel');
        initializeCarousel();
    });

    // Also initialize immediately in case DOMContentLoaded already fired
    if (document.readyState !== 'loading') {
        console.log('[CAROUSEL] DOM already loaded, initializing now');
        initializeCarousel();
    }

    // ========================================================================
    // BIDDING SYSTEM - AUCTION DETAIL PAGE
    // ========================================================================
    
    const auctionId = {{ auction.id }};
    const username = '{{ username }}' || null;
    const userId = {{ user_id or 'null' }};
    const auctionEndsAt = new Date('{{ auction.ends_at.isoformat() }}');
    
    // ========================================================================
    // COUNTDOWN TIMER
    // ========================================================================
    
    function updateCountdown() {
        const countdownEl = document.getElementById('countdown');
        const now = new Date();
        const diff = auctionEndsAt - now;
        
        if (diff <= 0) {
            countdownEl.textContent = '‚è∞ Auction Ended';
            countdownEl.parentElement.classList.add('bg-red-50', 'border-red-200');
            // Disable bid form if showing
            const bidForm = document.getElementById('bid-form');
            if (bidForm) {
                bidForm.style.display = 'none';
            }
            return;
        }
        
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
        const minutes = Math.floor((diff / 1000 / 60) % 60);
        const seconds = Math.floor((diff / 1000) % 60);
        
        countdownEl.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
    }
    
    // Update countdown every second
    updateCountdown();
    setInterval(updateCountdown, 1000);
    
    // ========================================================================
    // LOAD BID HISTORY
    // ========================================================================
    
    async function loadBidHistory() {
        try {
            const response = await fetch(`/api/auctions/${auctionId}/bids`);
            
            if (!response.ok) {
                console.error('Failed to load bids:', response.status);
                return;
            }
            
            const bids = await response.json();
            console.log('[BIDS] Loaded:', bids);
            
            const container = document.getElementById('bid-history-container');
            container.innerHTML = ''; // Clear loading message
            
            if (bids.length === 0) {
                container.innerHTML = '<p class="text-center text-slate-500 py-8">No bids yet. Be the first to bid!</p>';
                return;
            }
            
            // Sort bids by amount (highest first)
            bids.sort((a, b) => b.amount - a.amount);
            
            bids.forEach((bid, index) => {
                const bidEl = document.createElement('div');
                bidEl.className = `flex items-center justify-between p-3 rounded-lg ${
                    index === 0 ? 'bg-blue-50 border-2 border-blue-200' : 'bg-slate-50 border border-slate-200'
                }`;
                
                bidEl.innerHTML = `
                    <div class="flex-1">
                        <div class="flex items-center gap-2">
                            ${index === 0 ? 'üèÜ' : ''}
                            <p class="font-semibold text-slate-900">$${bid.amount.toFixed(2)}</p>
                            ${index === 0 ? '<span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded font-semibold">Highest</span>' : ''}
                        </div>
                        <p class="text-xs text-slate-600 mt-1">User #${bid.bidder_id}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-xs text-slate-500">${new Date(bid.bid_time).toLocaleString()}</p>
                    </div>
                `;
                
                container.appendChild(bidEl);
            });
            
        } catch (error) {
            console.error('[BIDS] Error loading:', error);
            const container = document.getElementById('bid-history-container');
            container.innerHTML = '<p class="text-center text-red-500 py-8">Failed to load bid history</p>';
        }
    }
    
    // Load bid history on page load
    document.addEventListener('DOMContentLoaded', () => {
        loadBidHistory();
    });
    
    // ========================================================================
    // SUBMIT BID
    // ========================================================================
    
    async function submitBid(event) {
        event.preventDefault();
        
        if (!username) {
            window.location.href = '/login';
            return false;
        }
        
        const bidAmountInput = document.getElementById('bid-amount');
        const bidAmount = parseFloat(bidAmountInput.value);
        const minBid = parseFloat(bidAmountInput.min);
        
        // Client-side validation
        if (isNaN(bidAmount) || bidAmount < minBid) {
            showBidError(`Bid must be at least $${minBid.toFixed(2)}`);
            return false;
        }
        
        // Disable form
        const submitBtn = document.getElementById('bid-submit-btn');
        const btnText = document.getElementById('btn-text');
        const btnSpinner = document.getElementById('btn-spinner');
        
        submitBtn.disabled = true;
        btnText.classList.add('hidden');
        btnSpinner.classList.remove('hidden');
        
        try {
            // Submit bid to backend
            const response = await fetch(`/api/auctions/${auctionId}/bid`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    amount: bidAmount
                }),
                credentials: 'same-origin'
            });
            
            const result = await response.json();
            console.log('[BID] Response:', result);
            
            if (response.ok) {
                // Success
                showBidSuccess(`Your bid of $${bidAmount.toFixed(2)} has been placed!`);
                bidAmountInput.value = '';
                
                // Reload bid history
                setTimeout(() => {
                    loadBidHistory();
                    updateMinimumBid(bidAmount);
                }, 500);
            } else {
                // Error from backend
                showBidError(result.detail || 'Failed to place bid');
            }
            
        } catch (error) {
            console.error('[BID] Error:', error);
            showBidError('Network error: ' + error.message);
        } finally {
            submitBtn.disabled = false;
            btnText.classList.remove('hidden');
            btnSpinner.classList.add('hidden');
        }
        
        return false;
    }
    
    // ========================================================================
    // HELPER FUNCTIONS
    // ========================================================================
    
    function updateMinimumBid(currentBid) {
        const bidAmountInput = document.getElementById('bid-amount');
        const newMinimum = currentBid + 1.00;
        bidAmountInput.min = newMinimum.toFixed(2);
        bidAmountInput.placeholder = newMinimum.toFixed(2);
    }
    
    function showBidError(message) {
        const errorEl = document.getElementById('bid-error');
        const errorMsg = document.getElementById('error-message');
        errorMsg.textContent = message;
        errorEl.classList.remove('hidden');
        
        // Hide success if showing
        document.getElementById('bid-success').classList.add('hidden');
        
        // Auto hide after 5 seconds
        setTimeout(() => {
            errorEl.classList.add('hidden');
        }, 5000);
    }
    
    function showBidSuccess(message) {
        const successEl = document.getElementById('bid-success');
        const successMsg = document.getElementById('success-message');
        successMsg.textContent = message;
        successEl.classList.remove('hidden');
        
        // Hide error if showing
        document.getElementById('bid-error').classList.add('hidden');
        
        // Auto hide after 5 seconds
        setTimeout(() => {
            successEl.classList.add('hidden');
        }, 5000);
    }
    
    // ========================================================================
    // LOAD WINNER INFO (if auction ended)
    // ========================================================================
    
    async function loadWinnerInfo() {
        const winnerEl = document.getElementById('winner-name');
        const endedWinnerEl = document.getElementById('ended-winner-name');
        
        if (!winnerEl && !endedWinnerEl) return;
        
        try {
            const response = await fetch(`/api/auctions/${auctionId}/winner`);
            if (response.ok) {
                const data = await response.json();
                if (data.winner_name) {
                    if (winnerEl) winnerEl.textContent = data.winner_name;
                    if (endedWinnerEl) endedWinnerEl.textContent = data.winner_name;
                }
            }
        } catch (error) {
            console.error('Failed to load winner info:', error);
        }
    }
    
    // Load winner info if auction ended
    {% if not auction.is_active %}
    document.addEventListener('DOMContentLoaded', loadWinnerInfo);
    {% endif %}
</script>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap');
    
    .font-serif {
        font-family: 'Merriweather', serif;
    }
    
    .prose {
        font-size: 1rem;
        line-height: 1.75;
    }
    
    .whitespace-pre-wrap {
        white-space: pre-wrap;
        word-wrap: break-word;
    }

    /* Countdown timer animation */
    #countdown {
        font-size: 0.875rem;
        letter-spacing: 0.05em;
    }
    
    /* Bid history scrolling */
    #bid-history-container {
        scrollbar-width: thin;
        scrollbar-color: rgba(71, 85, 105, 0.5) rgba(226, 232, 240, 1);
    }
    
    #bid-history-container::-webkit-scrollbar {
        width: 6px;
    }
    
    #bid-history-container::-webkit-scrollbar-track {
        background: #f1f5f9;
        border-radius: 10px;
    }
    
    #bid-history-container::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 10px;
    }
    
    #bid-history-container::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
    }

    /* Carousel responsive sizing */
    @media (max-width: 768px) {
        #carousel-image {
            max-height: 400px;
        }
    }

    @media (max-width: 480px) {
        #carousel-image {
            max-height: 300px;
        }
    }

    /* Sticky sidebar */
    @media (min-width: 1024px) {
        .sticky {
            position: sticky;
        }
    }

    /* Animations */
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: scale(0.95);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    @keyframes spin {
        to {
            transform: rotate(360deg);
        }
    }

    .animate-spin {
        animation: spin 1s linear infinite;
    }
</style>